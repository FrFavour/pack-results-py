# 程序使用说明

## 前言

原项目：[WeMingT/pack-results](https://github.com/WeMingT/pack-results)

该程序为对原项目的 Python 重构，并添加了新的功能，适用于无法执行 bat 脚本的设备。

该程序运行不需要原项目，但如果没有它，我的程序是不可能的，请支持它。

## 工具简介

该程序用于批量处理目录下多个子文件夹中的 `result` 文件夹，将每个 `result `文件夹的内容打包为 zip 文件，并以其上级父文件夹的名称命名。

## 功能特点

- 自动检测所有包含 `result` 文件夹的子目录
- 一次性处理多个文件夹
- 支持日文、中文及感叹号等特殊字符的文件夹名
- 生成详细的操作日志文件
- 错误检测和报告机制
- 使用 Python 内置的  **zipfile **模块实现文件或文件夹的压缩操作

## 使用方法

### 1. 安装 Python

安装 [Python](https://www.python.org/downloads/release/python-31011) **<= 3.12**，若设备中已有 Python 环境，可跳过此步骤。

> **验证安装：**
>
> Win + R 打开 cmd 终端，输入 `python` ，如果有显示 Python 版本信息并进入 Python 执行模式，则安装成功。

### 2. 程序放置

将 `pack_results.py` 放置在目标文件夹中。

例如：

```text
目标文件夹/
├── pack_results.py        # 脚本程序自身
├── zip_output/            # 生成的zip文件存放目录
│   ├── 项目A.zip
│   ├── 项目B.zip
│   └── 项目C.zip
├── 项目A/
│   └── result/            # 需要打包的文件夹
│       ├── 文件1.txt
│       └── 文件2.jpg
├── 项目B/
│   └── result/            # 需要打包的文件夹
│       ├── 文档.pdf
│       └── 图片.png
└── 项目C/
    └── result/            # 需要打包的文件夹
        └── 数据.xlsx
```

### 3. 运行程序

在目标文件夹中打开 `cmd` 终端

执行以下代码运行程序：

```powershell
python pack_results.py
```

### 4. 查看结果

程序运行后将在`zip_output`文件夹中生成：

- `项目A.zip` - 直接包含项目A/result/文件夹中的所有文件（无文件夹结构）
- `项目B.zip` - 直接包含项目B/result/文件夹中的所有文件（无文件夹结构）
- `项目C.zip` - 直接包含项目C/result/文件夹中的所有文件（无文件夹结构）
- `pack_log_YYYY-MM-DD_HH-MM-SS.txt` - 详细的操作日志文件 

所有生成的zip文件都会统一保存在`zip_output`目录中，便于管理。zip文件内直接包含result文件夹中的文件，无需额外的文件夹结构。

## 注意事项

1. **备份重要数据**：运行前请确保重要数据已备份
2. **文件覆盖**：如果目标zip文件已存在，会被覆盖
3. **权限要求**：确保对目录有读写权限
4. **路径限制**：避免使用过长的文件路径（Windows路径长度限制）

## 故障排除

**[提示] 当前目录下没有找到任何子文件夹**：

确保您在正确的父目录中运行此脚本。

**[提示] 请确保您在包含项目子文件夹的父目录中运行此脚本**：

目录中的子文件夹中确实存在名为 `result` 的文件夹，并且 `result` 文件夹不是空的。

